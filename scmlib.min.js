function ScmCore(a,b){if((this.node=document.getElementById(a))){var c=document.createElement("div");c.setAttribute("id","scmContent");c.setAttribute("width",this.node.clientWidth);c.setAttribute("height",this.node.clientHeight);c.setAttribute("style","position: absolute;");this.node.appendChild(c);this.width=this.node.clientWidth;this.height=this.node.clientHeight;this.content=document.getElementById("scmContent");this.layers=[];this.updateInterval=b||10;this.events=new ScmEvent("__coreConstruct__");if(!("bind" in Function.prototype)){Function.prototype.bind=function(d){var f=this;var e=Array.prototype.slice.call(arguments,1);return function(){return f.apply(d,e.length===0?arguments:arguments.length===0?e:e.concat(Array.prototype.slice.call(arguments,0)))}}}window.setInterval(this.update.bind(this),b)}else{console.error("SCM : #"+a+" doesn't exist !")}}ScmCore.prototype.push=function(b){var a=document.createElement("canvas");a.setAttribute("id","scm"+b.name.charAt(0).toUpperCase()+b.name.slice(1));a.setAttribute("width",this.width);a.setAttribute("height",this.height);a.setAttribute("style","z-index: "+b.zindex+"; position: absolute;");this.content.appendChild(a);this.layers.push(b)};ScmCore.prototype.getLayer=function(a){for(var b=0;b!=this.layers.length;b++){if(this.layers[b].name==a){return this.layers[b]}}console.error("Simple Canvas Manager : undefined reference to "+a+" layer !")};ScmCore.prototype.update=function(){for(var b=0;b!=this.layers.length;b++){if(typeof(this.layers[b])!="undefined"&&!this.layers[b].locked){this.layers[b].clear()}}for(var b=0;b!=this.layers.length;b++){for(var a=0;a!=this.layers[b].objects.length;a++){this.layers[b].drawAll()}}};function ScmLayer(b,c,a){this.name=b;this.zindex=c;this.htmlName="scm"+b.charAt(0).toUpperCase()+b.slice(1);this.locked=a||false;this.objects=[];this.textFont="sans-serif";this.textSize=10}ScmLayer.prototype.getHtmlElement=function(){return document.getElementById(this.htmlName)};ScmLayer.prototype.getContext=function(a){return this.getHtmlElement().getContext(a)};ScmLayer.prototype.setBackgroundColor=function(c){var b=this.getContext("2d"),d=b.canvas.clientWidth,a=b.canvas.clientHeight;b.fillStyle=c;b.fillRect(0,0,d,a);this.locked=true};ScmLayer.prototype.setBackgroundImg=function(c){var a=this.getContext("2d"),b=new Image();b.src=c;a.drawImage(b,0,0);this.locked=true};ScmLayer.prototype.setAlpha=function(b){var a=this.getContext("2d");a.globalAlpha=b;this.update(a)};ScmLayer.prototype.exist=function(a){for(var b=0;b!=this.objects.length;b++){if(this.objects[b]==a){return true}}return false};ScmLayer.prototype.draw=function(b){if(!this.exist(b)){this.objects.push(b)}var a=this.getContext("2d");if(b.alpha){a.save();a.globalAlpha=b.alpha}if(b.color){a.fillStyle=b.color}b.draw(a);if(b.alpha){a.restore()}};ScmLayer.prototype.drawAll=function(){var a=this.getContext("2d"),b;for(var c=0;c!=this.objects.length;c++){b=this.objects[c];if(b.alpha){a.save();a.globalAlpha=b.alpha}if(b.color){a.fillStyle=b.color}b.draw(a);if(b.alpha){a.restore()}}};ScmLayer.prototype.clear=function(){var b=this.getContext("2d"),c=b.canvas.clientWidth,a=b.canvas.clientHeight;b.clearRect(0,0,c,a)};ScmLayer.prototype.getTextConfig=function(){return{font:this.textFont,size:this.textSize}};ScmLayer.prototype.setTextConfig=function(a,b){this.textFont=a;this.textSize=b;this.getContext("2d").font=b+"px "+a};ScmLayer.prototype.lock=function(){this.locked=true};ScmLayer.prototype.unlock=function(){this.locked=false};function getValidObject(b,c){var a=c;if(typeof(b)!="undefined"){for(key in c){a[key]=((!b.hasOwnProperty(key))?(c[key]):(b[key]))}}return a}function ScmPixel(a,c,b){this.x=a;this.y=c;this.color=b;this.alpha=((typeof(alpha)!="undefined")?(alpha):(1))}ScmPixel.prototype.setAlpha=function(a){this.alpha=a};ScmPixel.prototype.draw=function(a){a.fillRect(this.x,this.y,1,1)};function ScmRect(b,e,d,a,c){this.x=b;this.y=e;this.width=d;this.height=a;this.color=c;this.alpha=((typeof(alpha)!="undefined")?(alpha):(1))}ScmRect.prototype.setPos=function(a,b){this.x=a;this.y=b};ScmRect.prototype.setSize=function(b,a){this.width=b;this.height=a};ScmRect.prototype.setWidth=function(a){this.width=a};ScmRect.prototype.setHeight=function(a){this.height=a};ScmRect.prototype.setColor=function(a){this.color=a};ScmRect.prototype.setAlpha=function(a){this.alpha=a};ScmRect.prototype.draw=function(a){a.fillRect(this.x,this.y,this.width,this.height)};function ScmCircle(a,d,c,b){this.x=a;this.y=d;this.diameter=c;this.color=b;this.alpha=((typeof(alpha)!="undefined")?(alpha):(1))}ScmCircle.prototype.setPos=function(a,b){this.x=a;this.y=b};ScmCircle.prototype.setDiameter=function(a){this.diameter=a};ScmCircle.prototype.setColor=function(a){this.color=a};ScmCircle.prototype.setAlpha=function(a){this.alpha=a};ScmCircle.prototype.draw=function(a){a.beginPath();a.arc(this.x,this.y,this.diameter,0,Math.PI*2,true);a.closePath();a.fill()};function ScmText(d,a,e,b,c){this.str=d;this.x=a;this.y=e;this.color=((typeof(b)!="undefined")?(b):("#000000"));this.alpha=((typeof(c)!="undefined")?(c):(1))}ScmText.prototype.setPos=function(a,b){this.x=a;this.y=b};ScmText.prototype.setAlpha=function(a){this.alpha=a};ScmText.prototype.draw=function(a){a.fillText(this.str,this.x,this.y)};function ScmImage(c,a,d,b){this.src=c;this.x=a;this.y=d;this.alpha=((typeof(b)!="undefined")?(b):(1))}ScmImage.prototype.setSrc=function(a){this.src=img};ScmImage.prototype.setPos=function(a,b){this.x=a;this.y=b};ScmImage.prototype.setX=function(a){this.x=x};ScmImage.prototype.setY=function(a){this.y=a};ScmImage.prototype.setAlpha=function(a){this.alpha=a};ScmImage.prototype.draw=function(b){var c=new Image(),a=this.x,d=this.y;c.onload=function(){b.drawImage(c,a,d)};c.src=this.src};function ScmEvent(b){if(!b||b!="__coreConstruct__"){console.warning("SCM : There is no need to construct a ScmEvent. You can simply use the ScmCore field called : events.")}this.ref={"37":{type:"LEFT_ARROW",callback:null},"38":{type:"UP_ARROW",callback:null},"39":{type:"RIGHT_ARROW",callback:null},"40":{type:"DOWN_ARROW",callback:null},};var a=this;document.onkeydown=function(c){var c=window.event||c;if(typeof(a.ref[c.keyCode])!="undefined"&&a.ref[c.keyCode].callback){(a.ref[c.keyCode].callback)()}}}ScmEvent.prototype.on=function(a,d){var c=false;for(var b in this.ref){if(this.ref[b].type==a){this.ref[b].callback=d;c=true}}if(!c){console.error("SCM : event "+a+" doesn't exist !")}return this};